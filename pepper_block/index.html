<html>
<head>
  <title>ペッパーＢＬＯＣＫ</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link type="text/css" rel="stylesheet" href="libs/jquery-ui-1.11.2/jquery-ui.css">
  <link type="text/css" rel="stylesheet" href="libs/jquery.mobile-1.4.5/jquery.mobile-1.4.5.min.css">
  <link type="text/css" rel="stylesheet" href="css/styles.css" />
  <script type='text/javascript' src='libs/jquery-2.1.3.js'></script>
  <script type='text/javascript' src='libs/jquery-ui-1.11.2/jquery-ui.js'></script>
  <script type='text/javascript' src="libs/jquery.mobile-1.4.5/jquery.mobile-1.4.5.min.js"></script>
  <script type='text/javascript' src="libs/jquery.ui.touch-punch.js"></script>
  <script type='text/javascript' src="libs/jquery.ui.dobletap.js"></script>
  <script type='text/javascript' src='libs/knockout-3.2.0.debug.js'></script>
  <script type='text/javascript' src="libs/qimessaging/1.0/qimessaging.js"></script>
  <script type='text/javascript' src="js/main.js"></script>
</head>
<body>
  <script type="text/html" id="block-space-start-template">
      <div class="hitAreaOrigin">
        <div class="hitAreaOut" style="top:-0.5em;left:1em;"></div>
      </div>
      <svg class="head_margin" data-bind="style:{
            top:  -0.5+'em',
            left:  0.0+'em',
            width:$parent.blockWidth()
        }">
        <rect x="0em" y="0.0em" width="5em" height="1.0em" fill="red" stroke="green" />
        <rect x="5em" y="0.9em" width="1em" height="0.1em" fill="red" stroke="green" data-bind="attr:{width:$parent.blockWidth()}" />
      </svg>
  </script>
  <script type="text/html" id="block-space-in-template">
      <div class="hitAreaOrigin" data-bind="style:{
            top:  -0.5+'em',
            left:  0.0+'em',
        }">
        <div class="hitAreaIn" style="top:-0.5em;left:0.5em;"></div>
      </div>
      <svg class="parts_margin" data-bind="style:{
            top:  -0.5+'em',
            left:  0.0+'em',
            width:$parent.blockWidth()
        }">
        <rect x="0.0em" y="0.1em" width="1.0em" height="0.4em" fill="red" stroke="green" />
        <rect x="1.0em" y="0.4em" width="1.0em" height="0.1em" fill="red" stroke="green" />
        <rect x="2.0em" y="0.1em" width="1.0em" height="0.4em" fill="red" stroke="green"
         data-bind="attr:{width:($parent.blockWidth())}" />
      </svg>
  </script>
  <script type="text/html" id="block-space-out-template">
      <div class="hitAreaOrigin" data-bind="style:{
            top:  $parent.blockHeight(),
            left:  0.0+'em',
        }">
        <div class="hitAreaOut" style="top:0.0em;left:0.5em;"></div>
      </div>
      <svg class="parts_margin" data-bind="style:{
            top:  $parent.blockHeight(),
            left:  0.0,
            width: $parent.blockWidth(),
        }">
        <rect x="0.0em" y="0.0em" width="1.0em" height="0.1em" fill="red" stroke="green" />
        <rect x="1.0em" y="0.0em" width="1.0em" height="0.4em" fill="red" stroke="green" />
        <rect x="2.0em" y="0.0em" width="1.0em" height="0.1em" fill="red" stroke="green" 
         data-bind="attr:{width:($parent.blockWidth())}" />
      </svg>
  </script>
  <script type="text/html" id="block-space-top-template">
      <svg class="parts_margin" data-bind="style:{width:$parent.blockWidth()}">
        <rect x="0.0em" y="0.0em" width="3.0em" height="0.5em" fill="red" stroke="green" />
      </svg>
  </script>
  <script type="text/html" id="block-space-bottom-template">
      <svg class="parts_margin" data-bind="style:{width:$parent.blockWidth()}">
        <rect x="0.0em" y="0.0em" width="3.0em" height="0.5em" fill="red" stroke="green" />
      </svg>
  </script>
  <script type="text/html" id="block-space-scope-top-template">
      <div class="hitAreaOrigin">
        <div class="hitAreaScopeOut" data-bind="attr:{id:$data.contentTemplate.scope.scopeName},style:{left:'1.75em'}"></div>
      </div>
      <svg class="parts_margin" data-bind="style:{width:$parent.blockWidth()}">
        <rect x="0.0em" y="0.0em" width="1.0em" height="0.5em" fill="red" stroke="green" />
        <rect x="2.0em" y="0.0em" width="1.0em" height="0.5em" fill="red" stroke="green" />
      </svg>
  </script>
  <script type="text/html" id="block-space-scope-bottom-template">
      <svg class="parts_margin" data-bind="style:{width:$parent.blockWidth()}">
        <rect x="0.0em" y="0.0em" width="1.0em" height="0.5em" fill="red" stroke="green" />
      </svg>
  </script>

  <script type="text/html" id="block-template">
      <div class="ui-widget-content block" 
           data-bind="with:$data,blockSetup:$data,
                      style:{left:   $data.posX(),
                             top:    $data.posY(),
                             width:  $data.blockWidth(),
                             height: $data.blockHeight(),},
                      blockLayout:$data,">
        <!-- ko foreach:$data.rowContents -->
          <div data-bind="if:$data.expressions">
            <div class="expressions blockRow" data-bind="style:{background:$parent.blockColor()}">
              <!-- ko foreach:$data.expressions -->
                <!-- ko if: $data.valueObsv!=null -->
                  <div class="hitAreaOrigin">
                    <div class="hitAreaValueIn" style="top:0;left:0;" data-bind="attr:{id:$data.dataTemplate.dataName}"></div>
                  </div>
                <!-- /ko -->

                <!-- ko if: $data.dataTemplate.label -->
                  <div class="label blockCell" data-bind="text:$data.dataTemplate.label"></div>
                <!-- /ko -->                

                <!-- ko if: $data.dataTemplate.string -->
                  <div class="string blockCell" data-bind="attr:{id:$data.dataTemplate.dataName},editableText:$data.valueObsv"></div>
                <!-- /ko -->
                
                <!-- ko if: $data.dataTemplate.number -->
                  <input class="number blockCell" data-bind="attr:{id:$data.dataTemplate.dataName},editableText:$data.valueObsv">
                <!-- /ko -->

                <!-- ko if: $data.dataTemplate.bool -->
                  <div class="bool blockCell" data-bind="attr:{id:$data.dataTemplate.dataName}">ブール</div>
                <!-- /ko -->
                
                <!-- ko if: $data.dataTemplate.options -->
                  <select class="options blockCell" data-bind="attr:{id:$data.dataTemplate.dataName},
                                                               optionsText:'text',
                                                               optionsValue:'value',
                                                               options:$data.dataTemplate.options.list,
                                                               value:$data.valueObsv,"></select>
                <!-- /ko -->
              <!-- /ko -->
            </div>
          </div>
          <div data-bind="if:$data.scopeOut">
            <div class="scope blockRow">
              <!-- ko template:'block-space-scope-top-template',data:$data -->
              <!-- /ko -->
              <svg class="scope blockCell">
                <rect x="0.0em" y="0.0em" width="1.0em" height="0.5em" fill="red" stroke="green" />
              </svg>
              <!-- ko template:'block-space-scope-bottom-template',data:$data -->
              <!-- /ko -->
            </div>
          </div>
          <div data-bind="if:$data.space">
            <div class="space blockRow">
              <div class="bg" data-bind="
                    style:{width:$parent.blockWidth(),
                           height:$data.rowHeight()},">
              </div>
            </div>
          </div>
        <!-- /ko -->

        <!-- ko if:$data.blockTemplate.blockOpt.head=='start' -->
          <!-- ko template:'block-space-start-template',data:$data -->
          <!-- /ko -->
        <!-- /ko -->
        <!-- ko if:$data.blockTemplate.blockOpt.head=='in' -->
          <!-- ko template:'block-space-in-template',data:$data -->
          <!-- /ko -->
        <!-- /ko -->
        <!-- ko if:$data.blockTemplate.blockOpt.head=='value' -->
          <div class="hitAreaOrigin">
            <div class="hitAreaValueOut" style="top:0.0;left:0.0;"></div>
          </div>
        <!-- /ko -->

        <!-- ko if:$data.blockTemplate.blockOpt.tail=='end' -->
          <!-- ko template:'block-space-bottom-template',data:$data -->
          <!-- /ko -->
        <!-- /ko -->
        <!-- ko if:$data.blockTemplate.blockOpt.tail=='out' -->
          <!-- ko template:'block-space-out-template',data:$data -->
          <!-- /ko -->
        <!-- /ko -->
      </div>
  </script>


  <div data-role="page"> 
    <div data-role="header">
      <h1>ペッパーＢＬＯＣＫ</h1>
    </div><!-- /header -->
    <div data-role="content">
        <div>version 0.100</div>
        <div>
          <div data-bind="text:$root.nowState"></div>
        </div>
        <div class="ipAddrInput">
          IP:
          <input type="text" pattern="\d{1,3}\" placeholder="000" data-bind="value: ipXXX_000_000_000" />
          <input type="text" pattern="\d{1,3}\" placeholder="000" data-bind="value: ip000_XXX_000_000" />
          <input type="text" pattern="\d{1,3}\" placeholder="000" data-bind="value: ip000_000_XXX_000" />
          <input type="text" pattern="\d{1,3}\" placeholder="000" data-bind="value: ip000_000_000_XXX" />
          <button data-bind="click: $root.connect">接続</button>
        </div>
        <div class="vButton">
          <button data-bind="click: $root.wakeupPepper">ペッパー起こす</button>
          <button data-bind="click: $root.restPepper">ペッパー寝かす</button>
        </div>
        <div class="vButton">
          <button data-bind="click: $root.execBlock">きどうスイッチ</button>
          <button data-bind="click: $root.stopBlock">すべてていし</button>
        </div>
        <div class="blockBox">
          <div id="pix2em" class="pix2em"></div>

          <div class="floatDraggingArea">
              <div data-bind="foreach:$root.blockManager.floatDraggingList">
                <div data-bind="template:'block-template',data:$data"></div>
              </div>
          </div>

          <div class="materialBox">
              そざい
              <div data-bind="foreach:$root.blockManager.materialList">
                <div data-bind="template:'block-template',data:$data"></div>
              </div>
          </div>
          <div class="toyBox">
              とい
              <div data-bind="foreach:$root.blockManager.toyList">
                <div data-bind="template:'block-template',data:$data"></div>
              </div>
          </div>
          <div class="factoryBox">
              ふぁくとり
              <div data-bind="foreach:$root.blockManager.factoryList">
                <div data-bind="template:'block-template',data:$data"></div>
              </div>
          </div>
        <div>

    </div><!-- /content -->
    <div data-role="footer">
      <h4>My Footer</h4>
    </div><!-- /footer -->
  </div><!-- /page -->
</body>
</html>
